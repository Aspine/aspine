<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="Aspine" content="Aspen Scraper and Beautifier">
        <link href="tabulator.css" rel="stylesheet">
        <script type="text/javascript" src="/tabulator/js/tabulator.min.js"></script>
        <link rel="stylesheet" type="text/css" href="stylesheet.css">
    </head>
    <body>
	<h4 id="title">Aspine</h4>
        <div id="example-table"></div>
        <div id="example-table2"></div>
        <script type="text/javascript">
            //create Tabulator on DOM element with id "example-table"
            let table2 = new Tabulator("#example-table2", {
                //height:205, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
                //data:tabledata[0].assignments, //assign data to table
                layout:"fitColumns", //fit columns to width of table (optional)
                columns:[ //Define Table Columns
                    {title:"Assignment", field:"name"},
                    {title:"Category", field:"category"},
                    {title:"Score", field:"score"},
                    {title:"Max Score", field:"max_score"},
                ],
                rowClick:function(e, row){ //trigger an alert message when the row is clicked
                    alert("Row " + row.getData().id + " Clicked!!!!");
                },
            });
            let table = new Tabulator("#example-table", {
                //height:205, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
                ajaxURL:"/data",
                ajaxConfig:"post", //ajax HTTP request type
                ajaxContentType:"json", // send parameters to the server as a JSON encoded string
                ajaxResponse:function(url, params, response){
                    //url - the URL of the request
                    //params - the parameters passed with the request
                    //response - the JSON object returned in the body of the response.
                    return response.classes; //return the tableData property of a response json object
                },
                //ajaxParams:{key1:"value1", key2:"value2"},
                //data:tabledata, //assign data to table
                layout:"fitColumns", //fit columns to width of table (optional)
                columns:[ //Define Table Columns
                    {title:"Class", field:"name"},
                    {title:"Grade", field:"grade", align:"center", formatter:function(cell, formatterParams){
		       var value = cell.getValue();
			  if(parseFloat(value) > 90){
        		    	return "<span style='color:green; font-weight:bold;'>" + value + "</span>";
        		} if(parseFloat(value) > 80){
        		    	return "<span style='color:blue; font-weight:bold;'>" + value + "</span>";
        		} if(parseFloat(value) > 70){
        		    	return "<span style='color:yellow; font-weight:bold;'>" + value + "</span>";
        		} if(parseFloat(value) > 60){
        		    	return "<span style='color:orange; font-weight:bold;'>" + value + "</span>";
        		} else{
        		    return value;
			}}},
                ],
                rowClick:function(e, row){ //trigger an alert message when the row is clicked
                    tabledata = table.getData();
                    for(let i in tabledata) {
                        if(tabledata[i].name == row.getData().name) {
                            table2.setData(tabledata[i].assignments);
                            return;
                        }
                    }
                },
            });
        </script>
    </body>
</html>
